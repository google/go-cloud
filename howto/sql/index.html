<!DOCTYPE html>
<html lang="en-us">
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="generator" content="Hugo 0.54.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>MySQL/PostgreSQL &middot; Go CDK</title>

  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Source+Code+Pro|Work+Sans:400,700">
  <link type="text/css" rel="stylesheet" href="/css/syntax.css">
  <link type="text/css" rel="stylesheet" href="/css/style.css">
  <link rel="shortcut icon" href="/favicon-32x32.png">
  
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-135118641-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body>
  <div class="PageLayout">
    <header class="PageHeader">
      <a href="https://gocloud.dev/"><h1 class="PageLogo"><img class="PageLogo-image" src="/go-cdk-logo-white.png" alt="Go CDK"></h1></a>
    </header>
    <main class="MainContent">
      <div class="MainContent-bounds"><h1>MySQL/PostgreSQL</h1>
<p>Connecting to cloud providers&rsquo; hosted database services requires additional
steps to ensure the security of the connection. For example, each of AWS,
GCP, and Azure require the use of custom certificate authorities to be
configured in the client. GCP requires a custom proxy with authentication
credentials. The Go CDK makes opening these connections easier while still
using the standard <a href="https://godoc.org/database/sql#DB"><code>*sql.DB</code></a> type.</p>

<h2 id="local"> Local or On-Premise<a class="anchor" href="#local" aria-label="Link to Section">ðŸ”—</a></h2>

<p>The Go CDK uses the same <a href="https://gocloud.dev/concepts/urls/">URL opener pattern</a> as seen in other Go CDK APIs. It
differs from the standard library&rsquo;s <code>sql.Open</code> in that it automatically
instruments the connection with <a href="https://opencensus.io/integrations/sql/go_sql/">OpenCensus metrics</a>.</p>

<p>The portable function for MySQL is <a href="https://godoc.org/gocloud.dev/mysql#Open"><code>mysql.Open</code></a>:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/mysql&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace this with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mysql</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;mysql://user:password@localhost/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<p>And the portable function for PostgreSQL is <a href="https://godoc.org/gocloud.dev/postgres#Open"><code>postgres.Open</code></a>:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/postgres&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace this with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">postgres</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;postgres://user:password@localhost/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<h2 id="aws"> AWS<a class="anchor" href="#aws" aria-label="Link to Section">ðŸ”—</a></h2>

<p>Users of <a href="https://aws.amazon.com/rds/mysql/">AWS RDS for MySQL</a> should import the <code>gocloud.dev/mysql/awsmysql</code> package:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/mysql&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;gocloud.dev/mysql/awsmysql&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace these with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mysql</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span>
	<span class="s">&#34;awsmysql://myrole:swordfish@example01.xyzzy.us-west-1.rds.amazonaws.com/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">ExecContext</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<p>Users of <a href="https://aws.amazon.com/rds/postgresql/">AWS RDS for PostgreSQL</a> should import the <code>gocloud.dev/postgres/awspostgres</code> package:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/postgres&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;gocloud.dev/postgres/awspostgres&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace these with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">postgres</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span>
	<span class="s">&#34;awspostgres://myrole:swordfish@example01.xyzzy.us-west-1.rds.amazonaws.com/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">ExecContext</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span> <span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<h2 id="gcp"> GCP<a class="anchor" href="#gcp" aria-label="Link to Section">ðŸ”—</a></h2>

<p>Users of <a href="https://cloud.google.com/sql/docs/mysql/">GCP Cloud SQL for MySQL</a> should import the <code>gocloud.dev/mysql/gcpmysql</code> package:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/mysql&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;gocloud.dev/mysql/gcpmysql&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace this with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mysql</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span>
	<span class="s">&#34;gcpmysql://user:password@example-project/region/my-instance01/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<p>Users of <a href="https://cloud.google.com/sql/docs/postgres/">GCP Cloud SQL for PostgreSQL</a> should import the <code>gocloud.dev/mysql/gcppostgres</code> package:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/postgres&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;gocloud.dev/postgres/gcppostgres&#34;</span>
<span class="p">)</span>

<span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">postgres</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span>
	<span class="s">&#34;gcppostgres://myrole@example-project/us-central1/my-instance01/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>

<h2 id="azure"> Azure<a class="anchor" href="#azure" aria-label="Link to Section">ðŸ”—</a></h2>

<p>Users of <a href="https://azure.microsoft.com/en-us/services/mysql/">Azure Database for MySQL</a> should import the <code>gocloud.dev/mysql/azuremysql</code> package:</p>

<div class="highlight"><pre class="chroma"><code class="language-go" data-lang="go"><span class="kn">import</span> <span class="p">(</span>
	<span class="s">&#34;context&#34;</span>

	<span class="s">&#34;gocloud.dev/mysql&#34;</span>
	<span class="nx">_</span> <span class="s">&#34;gocloud.dev/mysql/azuremysql&#34;</span>
<span class="p">)</span>

<span class="c1">// Replace this with your actual settings.
</span><span class="c1"></span><span class="nx">db</span><span class="p">,</span> <span class="nx">err</span> <span class="o">:=</span> <span class="nx">mysql</span><span class="p">.</span><span class="nf">Open</span><span class="p">(</span><span class="nx">ctx</span><span class="p">,</span>
	<span class="s">&#34;azuremysql://user:password@example00.mysql.database.azure.com/testdb&#34;</span><span class="p">)</span>
<span class="k">if</span> <span class="nx">err</span> <span class="o">!=</span> <span class="kc">nil</span> <span class="p">{</span>
	<span class="k">return</span> <span class="nx">err</span>
<span class="p">}</span>
<span class="k">defer</span> <span class="nx">db</span><span class="p">.</span><span class="nf">Close</span><span class="p">()</span>

<span class="c1">// Use database in your program.
</span><span class="c1"></span><span class="nx">db</span><span class="p">.</span><span class="nf">Exec</span><span class="p">(</span><span class="s">&#34;CREATE TABLE foo (bar INT);&#34;</span><span class="p">)</span>
</code></pre></div>
</div>
    </main>
    <nav class="Sidenav">
      <ul class="Sidenav-list">
        <li class="Sidenav-section">
          <a href="/" class="Sidenav-sectionLink">Home</a>
        </li>
        <li class="Sidenav-section">
          <a href="/tutorials/" class="Sidenav-sectionLink">Tutorials</a>
            <ul class="Sidenav-pageList">
              <li class="Sidenav-page">
                <a href="/tutorials/cli-uploader/" class="Sidenav-pageLink">Command-Line Uploader</a>
              </li>
              <li class="Sidenav-page">
                <a href="/tutorials/deploy-aws/" class="Sidenav-pageLink">Deploy to AWS</a>
              </li>
              <li class="Sidenav-page">
                <a href="/tutorials/deploy-gcp/" class="Sidenav-pageLink">Deploy to GCP</a>
              </li>
              <li class="Sidenav-page">
                <a href="/tutorials/deploy-azure/" class="Sidenav-pageLink">Connect to Azure</a>
              </li>
              
            </ul>
        </li>
        <li class="Sidenav-section">
          <a href="/howto/" class="Sidenav-sectionLink">How-To Guides</a>
            <ul class="Sidenav-pageList">
              
              <li class="Sidenav-page">
                <a href="/howto/blob/" class="Sidenav-pageLink">Blob</a>
              </li>
              <li class="Sidenav-page">
                <a href="/howto/sql/" class="Sidenav-pageLink">MySQL/PostgreSQL</a>
              </li>
              <li class="Sidenav-page">
                <a href="/howto/pubsub/" class="Sidenav-pageLink">Pub/Sub</a>
              </li>
              <li class="Sidenav-page">
                <a href="/howto/runtimervar/" class="Sidenav-pageLink">Runtime Configuration</a>
              </li>
              <li class="Sidenav-page">
                <a href="/howto/secrets/" class="Sidenav-pageLink">Secrets</a>
              </li>
            </ul>
        </li>
        <li class="Sidenav-section">
          <a href="/ref/" class="Sidenav-sectionLink">Reference</a>
            <ul class="Sidenav-pageList">
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/blob/" class="Sidenav-pageLink">blob</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/mysql/" class="Sidenav-pageLink">mysql</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/postgres/" class="Sidenav-pageLink">postgres</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/pubsub/" class="Sidenav-pageLink">pubsub</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/runtimevar/" class="Sidenav-pageLink">runtimevar</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/secrets/" class="Sidenav-pageLink">secrets</a>
              </li>
              <li class="Sidenav-page Sidenav-refPage">
                <a href="/ref/server/" class="Sidenav-pageLink">server</a>
              </li>
              
            </ul>
        </li>
        <li class="Sidenav-section">
          <a href="/concepts/" class="Sidenav-sectionLink">Concepts</a>
            <ul class="Sidenav-pageList">
              <li class="Sidenav-page">
                <a href="/concepts/structure/" class="Sidenav-pageLink">Structuring Portable Code</a>
              </li>
              <li class="Sidenav-page">
                <a href="/concepts/urls/" class="Sidenav-pageLink">URLs</a>
              </li>
              <li class="Sidenav-page">
                <a href="/concepts/as/" class="Sidenav-pageLink">Using provider-specific APIs</a>
              </li>
              
            </ul>
        </li>
      </ul>
    </nav>
    <footer class="PageFooter">
      <nav>
        <ul class="FooterLinks">
          <li class="FooterLinks-item"><a href="https://github.com/google/go-cloud/" class="FooterLinks-link">GitHub</a></li>
          <li class="FooterLinks-item"><a href="https://groups.google.com/forum/#!forum/go-cloud" class="FooterLinks-link">Google Groups</a></li>
          <li class="FooterLinks-item"><a href="mailto:go-cdk-feedback@google.com" class="FooterLinks-link">Contact Team</a></li>
        </ul>
      </nav>

      <p class="PageFooter-paragraph">
        Copyright Â© 2018â€“2019 The Go Cloud Development Kit Authors.
        All content released under an <a href="https://github.com/google/go-cloud/blob/master/LICENSE" target="_blank" class="PageFooter-link">Apache 2.0 License</a>.
      </p>
      <p class="PageFooter-paragraph"><a href="https://github.com/google/go-cloud/edit/master/internal/website/content/howto/sql/_index.md" class="PageFooter-link">Improve this page</a> on GitHub.</p>
    </footer>
  </div>
</body>
</html>
